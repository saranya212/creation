var global_array=new Array,tid=0,keycode=0,req_search=null,prev_hilighted_index=-1,hilighted_index=-1,enter=!1,result_bg_color="#FFFFFF",result_fg_color="#0066CC",result_hi_color="#CCCCCC";function search_keyword(e,t,i){var n=0;if(!t&&window.event&&(t=window.event),n=document.layers?(t.modifiers&Event.CONTROL_MASK)>0:t.ctrlKey,!tid)return keycode=t.keyCode,!!n||(!!isCtrlKey(keycode)||(isSendKey(keycode)&&(tid=setTimeout("SendQuery('"+e+"','"+i+"')",100)),UpDown(e,keycode)))}function isCtrlKey(e){return 16==e||17==e||18==e}function isSendKey(e){var t=!0;switch(e){case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 45:t=!1}return t}function SendQuery(e,t){tid=0;var i=document.getElementById("global_search").value;if(0!=i.length&&-1!=i.search(/\S/)){var n="/ti_forms/components/search_data_xml.html?keyword="+encodeURIComponent(i);req_search&&req_search.abort(),(req_search=window.XMLHttpRequest?new XMLHttpRequest:ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):"").open("GET",n,!0),req_search.onreadystatechange=new Function("Process('"+e+"')"),req_search.send(null)}else window.document.getElementById("h1_div").style.visibility="hidden",window.document.getElementById("search-suggestion").style.visibility="hidden",hide_div()}function Process(e){if(4==req_search.readyState)try{if(200==req_search.status)if(""==req_search.responseText)alert("empty response got"),hide_div();else{response=req_search.responseXML.documentElement;var t=response.getElementsByTagName("data"),i=(document.getElementById("global_search"),window.document.getElementById("sr_sugg"));for(ShowDiv(e);i.childNodes.length>0;)i.removeChild(i.childNodes[0]);t.length&&(window.document.getElementById("search-suggestion").style.visibility="visible",window.document.getElementById("h1_div").style.visibility="visible");global_array=new Array,t.length||(window.document.getElementById("search-suggestion").style.visibility="visible",window.document.getElementById("drp_dwn").style.visibility="hidden",window.document.getElementById("h1_div").style.visibility="hidden");for(var n=0;n<t.length;n++){var l=t[n].getElementsByTagName("search")[0].firstChild.nodeValue,d=(t[n].getElementsByTagName("count")[0].firstChild.nodeValue,t[n].getElementsByTagName("headline")[0].firstChild.nodeValue);"&nbsp;",global_array[n]=String(l);var s=document.createElement("a");s.setAttribute("class","suggestion-dynamic-item"),s.id=n;var r=document.createElement("SPAN");r.id=String("global_"+n);var a=document.createElement("SPAN");a.id=String("search_"+n),a.innerHTML=l,a.innerHTML=d,r.appendChild(a),s.appendChild(r),i.appendChild(s)}hilighted_index=-1,pre_hilighted_index=-1,enable_blur();$(".suggestion-dynamic-item").click(function(e){e.preventDefault(),$(".suggestion-dynamic-item").removeClass("search_li_highlight"),$(this).addClass("search_li_highlight");var t=$(this).text();document.getElementById("global_search").value=t,window.document.getElementById("h1_div").style.visibility="hidden",window.document.getElementById("search-suggestion").style.visibility="hidden",window.document.getElementById("sr_sugg").style.visibility="hidden",$(".suggestion-dynamic-item").parent()&&$(".suggestion-dynamic-item").parent().attr("data-val")&&$(".suggestion-dynamic-item").parent().attr("data-val").length>0||"sourcing"==$(".suggestion-dynamic-item").parent().attr("data-val")||document.global_search_form.submit()}),$("#search_btn").click(function(e){window.document.getElementById("h1_div").style.visibility="hidden",window.document.getElementById("search-suggestion").style.visibility="hidden"})}}catch(e){alert("in catch"+e)}}function setStyle(e,t){switch(t.charAt(0)){case"a":e.style.visibility="visible",e.style.width="80%",e.style.fontSize="12px",e.style.fontFamily="Verdana, Arial, Helvetica",e.style.color=result_fg_color,e.style.whiteSpace="nowrap",e.style.styleFloat="left",e.style.cssFloat="left",e.style.textAlign="left";break;case"b":e.style.visibility="visible",e.style.width="20%",e.style.fontSize="12px",e.style.fontFamily="Verdana, Arial, Helvetica",e.style.color="#0000DE",e.style.styleFloat="right",e.style.cssFloat="right",e.style.textAlign="right";break;case"c":e.style.width="100%",e.style.weight="bold",e.style.fontFamily="Verdana, Arial, Helvetica",e.style.fontSize="15px",e.style.styleFloat="left",e.style.cssFloat="left",e.style.textAlign="left"}}function ShowDiv(e){document.getElementById("sr_sugg").style.visibility="visible"}function hide_div(){global_array.length&&hide_all(),document.getElementById("sr_sugg").style.visibility="hidden"}function hide_div_later(){setTimeout("hide_div()",100)}function hide_all(){for(var e=0;e<global_array.length;e++)document.getElementById("search_"+e).style.visibility="hidden",document.getElementById("global_"+e).style.visibility="hidden",document.getElementById(e).style.visibility="hidden"}function isShowKey(e){return 40!=e&&38!=e&&33!=e&&34!=e&&13!=e}function handleCursorUpDownEnter(e,t){var i=document.getElementById("sr_sugg");if(40==e){if("visible"==i.style.visibility)return highlightNewValue(Number(hilighted_index)+Number(1),e,t),!1}else if(38==e){if("visible"==i.style.visibility)return highlightNewValue(hilighted_index-1,e,t),!1}else if(13==e||3==e)return 13==e&&(enter=!0,submitHandlerIncr1(t));return 0!=keycode&&ForEachKeyPressed(keycode,t),!0}function highlightNewValue(e,t,i){return e<0?(prev_hilighted_index>=0&&(change_background(prev_hilighted_index,"2"),prev_hilighted_index=-1),void(hilighted_index=-1)):e>global_array.length-1?(change_background(e-1,"1"),hilighted_index=global_array.length-1,void(prev_hilighted_index=global_array.length-1)):($("#global_search").val(global_array[e]),40==t&&(prev_hilighted_index>=0&&change_background(prev_hilighted_index,"2"),change_background(e,"1"),hilighted_index=e,prev_hilighted_index=e),void(38==t&&(prev_hilighted_index>=0&&change_background(prev_hilighted_index,"2"),change_background(e,"1"),hilighted_index=e,prev_hilighted_index=e)))}function change_background(e,t){switch(t.charAt(0)){case"1":document.getElementById("search_"+e).style.backgroundColor=result_hi_color,document.getElementById(e).style.backgroundColor=result_hi_color;break;case"2":document.getElementById("search_"+e).style.backgroundColor=result_bg_color,document.getElementById(e).style.backgroundColor=result_bg_color}}function mouse_in(e){basic_style(),change_background(e,"1"),hilighted_index=e,prev_hilighted_index=e,disable_blur()}function mouse_out(e){change_background(e,"2"),enable_blur()}function enable_blur(){document.getElementById("global_search")}function disable_blur(){document.getElementById("global_search").onblur=null}function basic_style(){for(i=0;i<global_array.length;i++)change_background(i,"2")}function findPosX(e){var t=0;if(e.offsetParent)for(;e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent;else e.x&&(t+=e.x);return t}function findPosY(e){var t=0;if(e.offsetParent)for(;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;else e.y&&(t+=e.y);return t}function ForEachKeyPressed(e,t){var i=document.getElementById("global_search"),n=document.getElementById("sr_sugg"),l=i.value,d=global_array.length;""!=l&&0!=d&&27!=keycode&&-1!=l.search(/\S/)&&("hidden"!=n.style.visibility||35!=keycode&&36!=keycode)||hide_div()}function submitHandlerIncr1(e){var t=document.getElementById(hilighted_index).id;document.getElementById("global_search").value=global_array[t],hide_div(),$(".classHighlight").length&&$(".suggestion-dynamic-item").removeClass(classHighlight),window.document.getElementById("h1_div").style.visibility="hidden",window.document.getElementById("search-suggestion").style.visibility="hidden",window.document.getElementById("sr_sugg").style.visibility="hidden","post_req_form"!=e.name&&document.global_search_form.submit()}function submitItem(e){alert("submit"),document.getElementById("global_search").value=String(global_array[e]),hide_div()}UpDown=function(e,t){return!(!handleCursorUpDownEnter(t,e)&&!isShowKey(t))};